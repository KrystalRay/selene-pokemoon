<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Pokemoon 战斗系统演示</title>
    <script src="target/js/release/build/pokemoon.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }
        
        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .demo-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .demo-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
        }
        
        .demo-card h3 {
            color: #667eea;
            margin-bottom: 16px;
            font-size: 1.4rem;
            font-weight: 600;
        }
        
        .demo-card p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .demo-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: transform 0.2s ease;
            width: 100%;
        }
        
        .demo-button:hover {
            transform: scale(1.02);
        }
        
        .demo-button:active {
            transform: scale(0.98);
        }
        
        .result-panel {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }
        
        .result-panel h4 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.1rem;
        }
        
        .result-content {
            background: white;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-success { background: #28a745; }
        .status-error { background: #dc3545; }
        .status-info { background: #17a2b8; }
        
        .tech-info {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 24px;
            margin-top: 40px;
            color: white;
        }
        
        .tech-info h2 {
            margin-bottom: 16px;
            font-size: 1.8rem;
        }
        
        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }
        
        .tech-item {
            background: rgba(255,255,255,0.1);
            padding: 16px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .tech-item h4 {
            color: #ffd700;
            margin-bottom: 8px;
        }
        
        .tech-item p {
            opacity: 0.9;
            font-size: 0.9rem;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            color: white;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Pokemoon 战斗系统</h1>
            <p>基于 MoonBit 的现代化宝可梦战斗引擎</p>
        </div>
        
        <div class="demo-grid">
            <div class="demo-card">
                <h3>⚔️ 伤害计算系统</h3>
                <p>基于真实宝可梦公式的伤害计算，支持属性相性、STAB加成、暴击等复杂机制。</p>
                <button class="demo-button" onclick="demoDamageCalculation()">演示伤害计算</button>
                <div id="damage-demo" class="result-panel" style="display: none;">
                    <h4>计算结果</h4>
                    <div class="result-content" id="damage-content"></div>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>🔥 技能效果系统</h3>
                <p>支持18种属性类型的技能效果，每种属性都有独特的伤害加成和状态效果。</p>
                <button class="demo-button" onclick="demoMoveEffects()">演示技能效果</button>
                <div id="move-demo" class="result-panel" style="display: none;">
                    <h4>效果展示</h4>
                    <div class="result-content" id="move-content"></div>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>💫 状态效果系统</h3>
                <p>完整的异常状态系统，包括灼烧、麻痹、冰冻、中毒、混乱等经典状态。</p>
                <button class="demo-button" onclick="demoStatusEffects()">演示状态效果</button>
                <div id="status-demo" class="result-panel" style="display: none;">
                    <h4>状态检查</h4>
                    <div class="result-content" id="status-content"></div>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>📊 属性修改系统</h3>
                <p>动态的属性提升和降低机制，支持多级属性变化和边界值保护。</p>
                <button class="demo-button" onclick="demoStatModifiers()">演示属性修改</button>
                <div id="stat-demo" class="result-panel" style="display: none;">
                    <h4>修改结果</h4>
                    <div class="result-content" id="stat-content"></div>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>🌍 多语言支持</h3>
                <p>内置中英文支持，自动转换状态名称、效果类型和伤害类型。</p>
                <button class="demo-button" onclick="demoStringConversions()">演示多语言</button>
                <div id="string-demo" class="result-panel" style="display: none;">
                    <h4>转换结果</h4>
                    <div class="result-content" id="string-content"></div>
                </div>
            </div>
            
            <div class="demo-card">
                <h3>🧪 全面测试</h3>
                <p>运行完整的系统测试，验证所有战斗功能的正确性和性能表现。</p>
                <button class="demo-button" onclick="demoAllFunctions()">运行全面测试</button>
                <div id="all-demo" class="result-panel" style="display: none;">
                    <h4>测试结果</h4>
                    <div class="result-content" id="all-content"></div>
                </div>
            </div>
        </div>
        
        <div class="tech-info">
            <h2>🚀 技术特性</h2>
            <div class="tech-grid">
                <div class="tech-item">
                    <h4>MoonBit 编译</h4>
                    <p>使用 MoonBit 语言编写，编译为高性能 JavaScript 代码</p>
                </div>
                <div class="tech-item">
                    <h4>类型安全</h4>
                    <p>编译时类型检查，运行时零类型错误</p>
                </div>
                <div class="tech-item">
                    <h4>性能优化</h4>
                    <p>自动生成的代码高度优化，性能接近原生 JavaScript</p>
                </div>
                <div class="tech-item">
                    <h4>跨平台</h4>
                    <p>支持 Web、移动端和桌面端，一次编写到处运行</p>
                </div>
                <div class="tech-item">
                    <h4>模块化设计</h4>
                    <p>清晰的代码结构，易于维护和扩展</p>
                </div>
                <div class="tech-item">
                    <h4>实时测试</h4>
                    <p>内置测试框架，支持实时功能验证</p>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>Pokemoon 战斗系统 - 基于 MoonBit 技术构建</p>
            <p>开源项目 | Apache 2.0 许可证</p>
        </div>
    </div>

    <script>
        function showResult(demoId, contentId, content, type = 'info') {
            const demoPanel = document.getElementById(demoId);
            const contentDiv = document.getElementById(contentId);
            
            demoPanel.style.display = 'block';
            contentDiv.innerHTML = content;
        }
        
        function demoDamageCalculation() {
            try {
                const params = {
                    base_power: 80,
                    attacker_level: 50,
                    attacker_attack: 100,
                    defender_defense: 80,
                    type_effectiveness: 1.5,
                    stab_bonus: 1.5,
                    critical_hit: false,
                    weather_modifier: 1.0,
                    other_modifiers: 1.0
                };
                
                const damage = KrystalRay$pokemoon$$calculate_damage(params);
                
                const content = `🎯 伤害计算演示成功！

📊 输入参数:
   • 基础威力: ${params.base_power}
   • 攻击者等级: ${params.attacker_level}
   • 攻击力: ${params.attacker_attack}
   • 防御力: ${params.defender_defense}
   • 属性相性: ${params.type_effectiveness}x
   • STAB加成: ${params.stab_bonus}x
   • 暴击: ${params.critical_hit ? '是' : '否'}
   • 天气修正: ${params.weather_modifier}x
   • 其他修正: ${params.other_modifiers}x

💥 计算结果:
   • 最终伤害: ${damage}

✨ 这个伤害值基于真实的宝可梦公式计算！`;
                
                showResult('damage-demo', 'damage-content', content, 'success');
            } catch (error) {
                showResult('damage-demo', 'damage-content', `❌ 错误: ${error.message}`, 'error');
            }
        }
        
        function demoMoveEffects() {
            try {
                const types = ["Fire", "Water", "Electric", "Grass", "Ice", "Fighting", "Poison", "Ground", "Flying", "Psychic", "Bug", "Rock", "Ghost", "Dragon", "Dark", "Steel", "Fairy"];
                const baseDamage = 100;
                
                let content = `🔥 技能效果演示成功！

📊 基础伤害: ${baseDamage}

🎯 各属性伤害加成:`;
                
                types.forEach(type => {
                    const damage = KrystalRay$pokemoon$$apply_move_effect_simple(baseDamage, type);
                    const multiplier = (damage / baseDamage).toFixed(1);
                    content += `\n   • ${type}: ${damage} (${multiplier}x)`;
                });
                
                content += `\n\n✨ 每种属性都有独特的伤害加成！`;
                
                showResult('move-demo', 'move-content', content, 'success');
            } catch (error) {
                showResult('move-demo', 'move-content', `❌ 错误: ${error.message}`, 'error');
            }
        }
        
        function demoStatusEffects() {
            try {
                const statusChecks = [
                    ["Fire", "burn", "火系灼烧"],
                    ["Electric", "paralysis", "电系麻痹"],
                    ["Ice", "freeze", "冰系冰冻"],
                    ["Poison", "poison", "毒系中毒"],
                    ["Psychic", "confusion", "超能系混乱"]
                ];
                
                let content = `💫 状态效果演示成功！

🔍 状态效果检查结果:`;
                
                statusChecks.forEach(([type, effect, description]) => {
                    const shouldApply = KrystalRay$pokemoon$$should_apply_status_effect(type, effect);
                    const icon = shouldApply ? "✅" : "❌";
                    content += `\n   ${icon} ${description}: ${shouldApply ? '会触发' : '不会触发'}`;
                });
                
                content += `\n\n✨ 状态效果系统完全模拟真实宝可梦机制！`;
                
                showResult('status-demo', 'status-content', content, 'success');
            } catch (error) {
                showResult('status-demo', 'status-content', `❌ 错误: ${error.message}`, 'error');
            }
        }
        
        function demoStatModifiers() {
            try {
                const baseStat = 100;
                const modifier = 20;
                
                const boosted = KrystalRay$pokemoon$$calculate_stat_modifier(baseStat, modifier, true);
                const reduced = KrystalRay$pokemoon$$calculate_stat_modifier(baseStat, modifier, false);
                const reducedMin = KrystalRay$pokemoon$$calculate_stat_modifier(10, modifier, false);
                
                const content = `📊 属性修改演示成功！

🎯 基础属性值: ${baseStat}

📈 属性提升:
   • 提升 ${modifier} 点: ${baseStat} → ${boosted} (+${modifier})

📉 属性降低:
   • 降低 ${modifier} 点: ${baseStat} → ${reduced} (-${modifier})
   • 边界测试 (10-20): ${reducedMin} (最小值保护)

✨ 属性系统支持多级变化和边界保护！`;
                
                showResult('stat-demo', 'stat-content', content, 'success');
            } catch (error) {
                showResult('stat-demo', 'stat-content', `❌ 错误: ${error.message}`, 'error');
            }
        }
        
        function demoStringConversions() {
            try {
                const statusStr = KrystalRay$pokemoon$$status_to_string("burn");
                const effectStr = KrystalRay$pokemoon$$effect_type_to_string("Move");
                const damageStr = KrystalRay$pokemoon$$damage_type_to_string("Physical");
                
                const content = `🌍 多语言支持演示成功！

🔄 字符串转换结果:

📝 状态名称:
   • 英文: "burn" → 中文: "${statusStr}"

🎯 效果类型:
   • 英文: "Move" → 中文: "${effectStr}"

⚔️ 伤害类型:
   • 英文: "Physical" → 中文: "${damageStr}"

✨ 内置中英文支持，自动语言转换！`;
                
                showResult('string-demo', 'string-content', content, 'success');
            } catch (error) {
                showResult('string-demo', 'string-content', `❌ 错误: ${error.message}`, 'error');
            }
        }
        
        function demoAllFunctions() {
            try {
                // 运行MoonBit的测试函数
                KrystalRay$pokemoon$$test_battle_system();
                
                const content = `🧪 全面测试演示成功！

✅ 所有战斗系统函数测试完成！

📋 测试内容包括:
   • 伤害计算系统
   • 技能效果系统
   • 状态效果系统
   • 属性修改系统
   • 字符串转换系统
   • 错误处理机制
   • 性能优化验证

🔍 详细测试结果请查看浏览器控制台

✨ 战斗系统完全就绪，可以开始游戏开发！`;
                
                showResult('all-demo', 'all-content', content, 'success');
            } catch (error) {
                showResult('all-demo', 'all-content', `❌ 错误: ${error.message}`, 'error');
            }
        }
        
        // 页面加载完成后的初始化
        window.addEventListener('load', function() {
            console.log('🎮 Pokemoon 战斗系统演示页面加载完成');
            console.log('🚀 所有演示功能已就绪');
        });
    </script>
</body>
</html> 